{"ast":null,"code":"import _regeneratorRuntime from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/src/containers/App.js\";\n\n/* eslint-disable react/destructuring-assignment */\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport classes from './App.module.css';\nimport Header from '../components/Header/Header';\nimport Coins from '../components/Coins/Coins';\nimport Spinner from '../components/UI/Spinner/Spinner';\nimport Button from '../components/UI/Button/Button';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      coins: [],\n      searchInput: '',\n      searchCoins: [],\n      changeTimeout: null,\n      startValue: 0,\n      error: false,\n      hasMore: true,\n      isLoading: false,\n      descending: true\n    };\n\n    _this.changeSearchInputHandler = function (event) {\n      _this.setState({\n        searchInput: event.target.value\n      });\n\n      if (_this.state.changeTimeout) {\n        clearTimeout(_this.state.changeTimeout);\n      }\n\n      var timeout = setTimeout(_this.searchCoins, 500);\n\n      _this.setState({\n        changeTimeout: timeout\n      });\n    };\n\n    _this.searchCoins = function () {\n      if (_this.state.searchInput !== '') {\n        var inputValue = _this.state.searchInput.toUpperCase();\n\n        var filteredData = [];\n\n        _this.state.coins.map(function (coin) {\n          var coinName = coin.name.toUpperCase();\n          var partOfCoinName = coinName.includes(inputValue);\n\n          if (partOfCoinName) {\n            filteredData.push(coin);\n          }\n\n          return filteredData;\n        });\n\n        _this.setState({\n          searchCoins: filteredData\n        });\n      } else {\n        // eslint-disable-next-line react/no-access-state-in-setstate\n        _this.setState({\n          searchCoins: _this.state.coins\n        });\n      }\n    };\n\n    _this.apiResultToArray = function (result) {\n      var transformedData = Object.keys(result.data.data).map(function (key) {\n        return _toConsumableArray(Array(result.data.data[key])).map(function (coin) {\n          return coin;\n        });\n      }).reduce(function (arr, el) {\n        return arr.concat(el);\n      }, []);\n      return transformedData;\n    };\n\n    _this.handleScroll = function () {\n      var _assertThisInitialize = _assertThisInitialized(_this),\n          loadCoinCards = _assertThisInitialize.loadCoinCards,\n          _assertThisInitialize2 = _assertThisInitialize.state,\n          error = _assertThisInitialize2.error,\n          isLoading = _assertThisInitialize2.isLoading,\n          hasMore = _assertThisInitialize2.hasMore;\n\n      if (error || isLoading || !hasMore) return; // Checks that the page has scrolled to the bottom\n\n      if (window.innerHeight + document.documentElement.scrollTop === document.documentElement.offsetHeight) {\n        loadCoinCards();\n      }\n    };\n\n    _this.loadCoinCards = function () {\n      var _assertThisInitialize3 = _assertThisInitialized(_this),\n          _assertThisInitialize4 = _assertThisInitialize3.state,\n          startValue = _assertThisInitialize4.startValue,\n          coins = _assertThisInitialize4.coins,\n          searchCoins = _assertThisInitialize4.searchCoins;\n\n      _this.setState({\n        isLoading: true\n      },\n      /*#__PURE__*/\n      _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var results, resultsArray;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return axios.get(\"?start=\".concat(startValue, \"&limit=12\"));\n\n              case 3:\n                results = _context.sent;\n                resultsArray = _this.apiResultToArray(results);\n\n                _this.setState({\n                  startValue: startValue + 13,\n                  hasMore: coins.length < 2093,\n                  isLoading: false,\n                  coins: [].concat(_toConsumableArray(coins), _toConsumableArray(resultsArray)),\n                  searchCoins: [].concat(_toConsumableArray(searchCoins), _toConsumableArray(resultsArray))\n                });\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n\n                _this.setState({\n                  error: _context.t0.message,\n                  isLoading: false\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 8]]);\n      })));\n    };\n\n    _this.sortCoinCard = function (des, type) {\n      var _assertThisInitialize5 = _assertThisInitialized(_this),\n          _assertThisInitialize6 = _assertThisInitialize5.state,\n          searchCoins = _assertThisInitialize6.searchCoins,\n          descending = _assertThisInitialize6.descending; // Check sort mode: descending or ascending\n\n\n      var mod = des ? 1 : -1;\n\n      var sortCoinCards = _toConsumableArray(searchCoins);\n\n      var valueA;\n      var valueB;\n      sortCoinCards.sort(function (a, b) {\n        if (type === 'price') {\n          valueA = a.quotes.USD[type];\n          valueB = b.quotes.USD[type];\n        } else {\n          valueA = a[type];\n          valueB = b[type];\n        } // Switch mode\n\n\n        if (valueA < valueB) {\n          return 1 * mod;\n        }\n\n        if (valueA > valueB) {\n          return -1 * mod;\n        }\n\n        return 0;\n      });\n\n      if (descending) {\n        _this.setState({\n          descending: false\n        });\n      } else {\n        _this.setState({\n          descending: true\n        });\n      }\n\n      _this.setState({\n        searchCoins: sortCoinCards\n      });\n    };\n\n    _this.getSortTypeDataFromChild = function (dataFromChild) {\n      var sortTypeArr = dataFromChild;\n      return sortTypeArr;\n    };\n\n    _this.componentWillMount = function () {\n      _this.loadCoinCards();\n    };\n\n    _this.componentDidMount = function () {\n      window.addEventListener('scroll', _this.handleScroll);\n    };\n\n    _this.componentWillUnmount = function () {\n      window.addEventListener('scroll', _this.handleScroll);\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          searchInput = _this$state.searchInput,\n          searchCoins = _this$state.searchCoins,\n          error = _this$state.error,\n          hasMore = _this$state.hasMore,\n          isLoading = _this$state.isLoading,\n          descending = _this$state.descending;\n      var sortValueArr = ['name', 'rank', 'price'];\n      return React.createElement(\"div\", {\n        className: classes.bgLightGray,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(Header, {\n        searchInputApp: searchInput,\n        changeSearchValueApp: this.changeSearchInputHandler,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(Button, {\n        clickedSortApp: this.sortCoinCard,\n        desOrAsceApp: descending,\n        sortValueNameApp: sortValueArr[0],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, \"Sort by name\"), React.createElement(Button, {\n        clickedSortApp: this.sortCoinCard,\n        desOrAsceApp: descending,\n        sortValueNameApp: sortValueArr[1],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"Sort by rank\"), React.createElement(Button, {\n        clickedSortApp: this.sortCoinCard,\n        desOrAsceApp: descending,\n        sortValueNameApp: sortValueArr[2],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, \"Sort by price\"), React.createElement(Coins, {\n        coinsDataApp: searchCoins,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"container text-center pb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, error && React.createElement(\"div\", {\n        style: {\n          color: '#900'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, error), isLoading && React.createElement(Spinner, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }), !hasMore && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, \"You reached the end!\"))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/KietN/Documents/Personal projects/cryptocurrency-coins-react/src/containers/App.js"],"names":["React","Component","axios","classes","Header","Coins","Spinner","Button","App","state","coins","searchInput","searchCoins","changeTimeout","startValue","error","hasMore","isLoading","descending","changeSearchInputHandler","event","setState","target","value","clearTimeout","timeout","setTimeout","inputValue","toUpperCase","filteredData","map","coin","coinName","name","partOfCoinName","includes","push","apiResultToArray","result","transformedData","Object","keys","data","key","Array","reduce","arr","el","concat","handleScroll","loadCoinCards","window","innerHeight","document","documentElement","scrollTop","offsetHeight","get","results","resultsArray","length","message","sortCoinCard","des","type","mod","sortCoinCards","valueA","valueB","sort","a","b","quotes","USD","getSortTypeDataFromChild","dataFromChild","sortTypeArr","componentWillMount","componentDidMount","addEventListener","componentWillUnmount","sortValueArr","bgLightGray","color"],"mappings":"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","sourcesContent":["/* eslint-disable react/destructuring-assignment */\nimport React, { Component } from 'react';\nimport axios from 'axios';\n\nimport classes from './App.module.css';\nimport Header from '../components/Header/Header';\nimport Coins from '../components/Coins/Coins';\nimport Spinner from '../components/UI/Spinner/Spinner';\nimport Button from '../components/UI/Button/Button';\n\nclass App extends Component {\n  state = {\n    coins: [],\n    searchInput: '',\n    searchCoins: [],\n    changeTimeout: null,\n    startValue: 0,\n    error: false,\n    hasMore: true,\n    isLoading: false,\n    descending: true,\n  }\n\n  changeSearchInputHandler = (event) => {\n    this.setState({ searchInput: event.target.value });\n\n    if (this.state.changeTimeout) {\n      clearTimeout(this.state.changeTimeout);\n    }\n\n    const timeout = setTimeout(this.searchCoins, 500);\n    this.setState({\n      changeTimeout: timeout,\n    });\n  }\n\n  searchCoins = () => {\n    if (this.state.searchInput !== '') {\n      const inputValue = this.state.searchInput.toUpperCase();\n      const filteredData = [];\n\n      this.state.coins.map((coin) => {\n        const coinName = coin.name.toUpperCase();\n        const partOfCoinName = coinName.includes(inputValue);\n\n        if (partOfCoinName) {\n          filteredData.push(coin);\n        }\n        return filteredData;\n      });\n      this.setState({ searchCoins: filteredData });\n    } else {\n      // eslint-disable-next-line react/no-access-state-in-setstate\n      this.setState({ searchCoins: this.state.coins });\n    }\n  }\n\n  apiResultToArray = (result) => {\n    const transformedData = Object.keys(result.data.data)\n      .map(key => [...Array(result.data.data[key])]\n        .map(coin => coin))\n      .reduce((arr, el) => arr.concat(el), []);\n    return transformedData;\n  }\n\n  handleScroll = () => {\n    const {\n      loadCoinCards,\n      state: {\n        error,\n        isLoading,\n        hasMore,\n      },\n    } = this;\n\n    if (error || isLoading || !hasMore) return;\n\n    // Checks that the page has scrolled to the bottom\n    if (\n      window.innerHeight + document.documentElement.scrollTop\n      === document.documentElement.offsetHeight\n    ) {\n      loadCoinCards();\n    }\n  }\n\n  loadCoinCards = () => {\n    const {\n      state: {\n        startValue,\n        coins,\n        searchCoins,\n      },\n    } = this;\n\n    this.setState({ isLoading: true }, async () => {\n      try {\n        const results = await axios.get(`?start=${startValue}&limit=12`);\n        const resultsArray = this.apiResultToArray(results);\n        this.setState({\n          startValue: startValue + 13,\n          hasMore: coins.length < 2093,\n          isLoading: false,\n          coins: [\n            ...coins,\n            ...resultsArray,\n          ],\n          searchCoins: [\n            ...searchCoins,\n            ...resultsArray,\n          ],\n        });\n      } catch (error) {\n        this.setState({\n          error: error.message,\n          isLoading: false,\n        });\n      }\n    });\n  }\n\n  sortCoinCard = (des, type) => {\n    const {\n      state: {\n        searchCoins,\n        descending,\n      },\n    } = this;\n    // Check sort mode: descending or ascending\n    const mod = des ? 1 : -1;\n\n    const sortCoinCards = [...searchCoins];\n    let valueA;\n    let valueB;\n\n    sortCoinCards.sort((a, b) => {\n      if (type === 'price') {\n        valueA = a.quotes.USD[type];\n        valueB = b.quotes.USD[type];\n      } else {\n        valueA = a[type];\n        valueB = b[type];\n      }\n      // Switch mode\n      if (valueA < valueB) {\n        return 1 * mod;\n      } if (valueA > valueB) {\n        return -1 * mod;\n      }\n      return 0;\n    });\n\n    if (descending) {\n      this.setState({ descending: false });\n    } else {\n      this.setState({ descending: true });\n    }\n    this.setState({ searchCoins: sortCoinCards });\n  }\n\n  getSortTypeDataFromChild = (dataFromChild) => {\n    const sortTypeArr = dataFromChild;\n    return sortTypeArr;\n  }\n\n  componentWillMount = () => {\n    this.loadCoinCards();\n  }\n\n  componentDidMount = () => {\n    window.addEventListener('scroll', this.handleScroll);\n  }\n\n  componentWillUnmount = () => {\n    window.addEventListener('scroll', this.handleScroll);\n  }\n\n  render() {\n    const {\n      searchInput,\n      searchCoins,\n      error,\n      hasMore,\n      isLoading,\n      descending,\n    } = this.state;\n\n    const sortValueArr = ['name', 'rank', 'price'];\n\n    return (\n      <div className={classes.bgLightGray}>\n        <Header\n          searchInputApp={searchInput}\n          changeSearchValueApp={this.changeSearchInputHandler}\n        />\n\n        <div className=\"container\">\n          <Button\n            clickedSortApp={this.sortCoinCard}\n            desOrAsceApp={descending}\n            sortValueNameApp={sortValueArr[0]}\n          >\n            Sort by name\n          </Button>\n          <Button\n            clickedSortApp={this.sortCoinCard}\n            desOrAsceApp={descending}\n            sortValueNameApp={sortValueArr[1]}\n          >\n            Sort by rank\n          </Button>\n          <Button\n            clickedSortApp={this.sortCoinCard}\n            desOrAsceApp={descending}\n            sortValueNameApp={sortValueArr[2]}\n          >\n            Sort by price\n          </Button>\n\n          <Coins coinsDataApp={searchCoins} />\n\n          <div className=\"container text-center pb-5\">\n            {error && (\n              <div style={{ color: '#900' }}>\n                {error}\n              </div>\n            )}\n\n            {isLoading && (\n              <Spinner />\n            )}\n\n            {!hasMore && (\n              <div>You reached the end!</div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}